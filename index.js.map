{
  "version": 3,
  "sources": ["src/index.ts", "src/utils.ts"],
  "sourcesContent": ["import { writeFile as writeFileCb } from \"fs\";\nimport fetch from \"node-fetch\";\nimport { promisify } from \"util\";\nimport { getItems } from \"./utils\";\n\nconst writeFile = promisify(writeFileCb);\n\nconst feedUrl = process.env.FEED_URL;\nif (feedUrl === undefined) {\n  throw new Error(\"environment variable FEED_ENV needs to be set\");\n}\n\nasync function main() {\n  const data = await fetch(feedUrl);\n  const xml = await data.text();\n\n  const items = getItems(xml);\n\n  await writeFile(\"~/items.json\", JSON.stringify(items), \"utf-8\");\n}\n\nmain()\n  .then(() => console.log(\"done.\"))\n  .catch((err) => console.error(err));\n", "import type { Item } from \"./types\";\n\nimport { XMLParser } from \"fast-xml-parser\";\n\nconst parser = new XMLParser({\n  stopNodes: [\"rss.channel.item.description\"],\n});\n\nexport function removeContentDataSection(string: string): string {\n  if (string.startsWith(\"<![CDATA[\") && string.endsWith(\"]]>\")) {\n    return string\n      .replace(\"<![CDATA[\", \"\")\n      .replace(\"]]>\", \"\")\n      .trimStart()\n      .trimEnd();\n  }\n  return string;\n}\n\nexport function removeHtmlTags(string: string): string {\n  return string.replace(/(<([^>]+)>)/gi, \"\");\n}\n\nexport function getItems(xml: string): Array<Item> {\n  const document = parser.parse(xml);\n  const itemsMap = document.rss.channel.item;\n\n  let items: Array<Item> = [];\n  if (Array.isArray(itemsMap)) {\n    items = itemsMap;\n  } else {\n    items.push(itemsMap);\n  }\n\n  const cleanedItems = items.map((item) => {\n    const { description, ...otherProps } = item;\n    return {\n      ...otherProps,\n      description: removeHtmlTags(removeContentDataSection(description)),\n    };\n  });\n\n  return cleanedItems;\n}\n"],
  "mappings": "ygCAAA,MAAyC,cACzC,EAAkB,yBAClB,EAA0B,gBCA1B,MAA0B,2BAEpB,EAAS,GAAI,aAAU,CAC3B,UAAW,CAAC,kCAGP,WAAkC,EAAwB,CAC/D,MAAI,GAAO,WAAW,cAAgB,EAAO,SAAS,OAC7C,EACJ,QAAQ,YAAa,IACrB,QAAQ,MAAO,IACf,YACA,UAEE,EAGF,WAAwB,EAAwB,CACrD,MAAO,GAAO,QAAQ,gBAAiB,IAGlC,WAAkB,EAA0B,CAEjD,GAAM,GAAW,AADA,EAAO,MAAM,GACJ,IAAI,QAAQ,KAElC,EAAqB,GACzB,MAAI,OAAM,QAAQ,GAChB,EAAQ,EAER,EAAM,KAAK,GAGQ,EAAM,IAAI,AAAC,GAAS,CACvC,GAAuC,KAA/B,gBAA+B,EAAf,IAAe,EAAf,CAAhB,gBACR,MAAO,QACF,GADE,CAEL,YAAa,EAAe,EAAyB,QDjC3D,GAAM,GAAY,gBAAU,aAEtB,EAAU,QAAQ,IAAI,SAC5B,GAAI,IAAY,OACd,KAAM,IAAI,OAAM,iDAGlB,kBAAsB,CAEpB,GAAM,GAAM,KAAM,AADL,MAAM,cAAM,IACF,OAEjB,EAAQ,EAAS,GAEvB,KAAM,GAAU,eAAgB,KAAK,UAAU,GAAQ,SAGzD,IACG,KAAK,IAAM,QAAQ,IAAI,UACvB,MAAM,AAAC,GAAQ,QAAQ,MAAM",
  "names": []
}
