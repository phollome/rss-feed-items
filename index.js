var F=Object.create;var i=Object.defineProperty,T=Object.defineProperties,C=Object.getOwnPropertyDescriptor,L=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertyNames,s=Object.getOwnPropertySymbols,S=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;var p=(e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))m.call(t,r)&&p(e,r,t[r]);if(s)for(var r of s(t))f.call(t,r)&&p(e,r,t[r]);return e},l=(e,t)=>T(e,L(t)),N=e=>i(e,"__esModule",{value:!0});var u=(e,t)=>{var r={};for(var n in e)m.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&s)for(var n of s(e))t.indexOf(n)<0&&f.call(e,n)&&(r[n]=e[n]);return r};var P=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of M(t))!m.call(e,o)&&(r||o!=="default")&&i(e,o,{get:()=>t[o],enumerable:!(n=C(t,o))||n.enumerable});return e},_=(e,t)=>P(N(i(e!=null?F(S(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var A=require("fs"),E=require("util");var h=_(require("https")),I=require("fast-xml-parser"),U=new I.XMLParser({stopNodes:["rss.channel.item.description"]});function W(e){return e.startsWith("<![CDATA[")&&e.endsWith("]]>")?e.replace("<![CDATA[","").replace("]]>","").trimStart().trimEnd():e}function j(e){return e.replace(/(<([^>]+)>)/gi,"")}function g(e,t=-1){let n=U.parse(e).rss.channel.item,o=[];return Array.isArray(n)?o=n:o.push(n),t>-1&&(o=o.slice(0,t)),o.map(v=>{let a=v,{description:x}=a,D=u(a,["description"]);return l(d({},D),{description:j(W(x))})})}function y(e){return new Promise((t,r)=>{h.get(e,n=>{let o="";n.on("data",c=>{o+=c}),n.on("end",()=>t(o))}).on("error",n=>r(n))})}var H=(0,E.promisify)(A.writeFile),b=process.env.FEED_URL;if(b===void 0)throw new Error("environment variable FEED_ENV needs to be set");var w=process.env.ITEMS_LIMIT;async function J(){let e=await y(b),t;w!==void 0&&(t=parseInt(w));let r=g(e,t);await H("./items.json",JSON.stringify(r),"utf-8")}J().then(()=>console.log("done.")).catch(e=>console.error(e));
//# sourceMappingURL=index.js.map
